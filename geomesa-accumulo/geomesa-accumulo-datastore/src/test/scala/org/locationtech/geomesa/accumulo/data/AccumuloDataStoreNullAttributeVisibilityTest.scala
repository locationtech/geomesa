/***********************************************************************
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
 * Crown Copyright (c) 2016-2024 Dstl
=======
=======
>>>>>>> 58c93ed806 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 90c7b688e9 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 422349e56d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> d136bd4a2c (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> 903b3b81c6 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> b368bb796e (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> c8d2cfae9c (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> 5e3d21a94f (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 823f734cb8 (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> 3fce3b91e5 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 0fc2920d6d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 50088d24c0 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> f76413defa (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> b0d44cc502 (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> aa977ecc5f (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> c5ef523249 (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> 82122ae50e (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> acd22640e2 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 03796f30c1 (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> a84d1830af (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 6c202d4480 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
>>>>>>> a4d0fcd200 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 838b7e581b (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 6f08de2ab4 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> e0d00527f8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 93a68e91bb (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> c576183101 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 6841c84934 (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> dbed56f042 (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> ed2e337c3d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> b71b0e3cfc (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> e7e01a7501 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> d66521d8df (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 582d9c96fe (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> eb88cebc2b (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 09e1125c28 (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> 3804445eba (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> b5fb9c834b (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> 2d904e5c26 (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> bfe6dff453 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 25ff9d478a (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> 8b6c6d5923 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 3689edc98a (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> 44b956e093 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
=======
>>>>>>> a4d0fcd200 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> ef6b8fccdb (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 6f57a76c5d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 71dfaa45da (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 6f08de2ab4 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 9838ac675d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> e0d00527f8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 34472778d3 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 93a68e91bb (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> 6b41bcc08d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> c576183101 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 42e8565e9b (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 6841c84934 (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> f1532f2313 (GEOMESA-3254 Add Bloop build support)
<<<<<<< HEAD
>>>>>>> dbed56f042 (GEOMESA-3254 Add Bloop build support)
=======
=======
>>>>>>> 7bbbc378d7 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> ed2e337c3d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 67de3c3202 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> b71b0e3cfc (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> 2f0f322607 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> e7e01a7501 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> bc2855a0cb (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> d66521d8df (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 9f85c4fe46 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 582d9c96fe (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 26051bd32c (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> eb88cebc2b (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 638b68d081 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 09e1125c28 (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> 59746cdccd (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 3804445eba (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 71adb695c5 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> b5fb9c834b (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> 5a4c24e020 (GEOMESA-3254 Add Bloop build support)
<<<<<<< HEAD
>>>>>>> 2d904e5c26 (GEOMESA-3254 Add Bloop build support)
=======
=======
>>>>>>> 4b71543a85 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> bfe6dff453 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 30559ea5c9 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 25ff9d478a (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> b818c64b86 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 8b6c6d5923 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> ec6d06b576 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 3689edc98a (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> 5369b95fd8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 44b956e093 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
 * Crown Copyright (c) 2016-2023 Dstl
=======
 * Crown Copyright (c) 2016-2021 Dstl
>>>>>>> e5f251e08c (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
>>>>>>> 1913317092 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 838b7e581b (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 6f57a76c5d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 44b956e093 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 21f7547af3 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> d1ecc0df13 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> e980963df5 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> db8d998aa2 (Merge branch 'feature/postgis-fixes')
=======
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> 1b25d7ddb4 (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> 42fbaa6c7a (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> edb78e59da (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 04a99577c4 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> eb2fe3d44d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> e944f1c88b (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> dd15127a4b (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 26e5afc4ea (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> 63a045a753 (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> b34574273f (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> c69897d7bd (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> 2f0f322607 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> edb78e59da (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> bc2855a0cb (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 9f85c4fe46 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> eb2fe3d44d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 26051bd32c (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 638b68d081 (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> dd15127a4b (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 59746cdccd (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 71adb695c5 (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> 63a045a753 (GEOMESA-3254 Add Bloop build support)
>>>>>>> 5a4c24e020 (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> 4b71543a85 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> c69897d7bd (Merge branch 'feature/postgis-fixes')
>>>>>>> 30559ea5c9 (Merge branch 'feature/postgis-fixes')
 * Crown Copyright (c) 2016-2023 Dstl
=======
=======
>>>>>>> db8d998aa (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> e22b6ade6f (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> ef6b8fccdb (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 71dfaa45da (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> d1ecc0df13 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 9838ac675d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 6b41bcc08d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> db8d998aa2 (Merge branch 'feature/postgis-fixes')
>>>>>>> 42e8565e9b (Merge branch 'feature/postgis-fixes')
=======
=======
=======
>>>>>>> 1b25d7ddb4 (Merge branch 'feature/postgis-fixes')
>>>>>>> 67de3c3202 (Merge branch 'feature/postgis-fixes')
 * Crown Copyright (c) 2016-2023 Dstl
=======
=======
>>>>>>> db8d998aa (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> e22b6ade6f (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 7bbbc378d7 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
 * Crown Copyright (c) 2016-2022 Dstl
=======
 * Crown Copyright (c) 2016-2021 Dstl
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> 9838ac675d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 6b41bcc08d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 42e8565e9b (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> 7bbbc378d7 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 67de3c3202 (Merge branch 'feature/postgis-fixes')
>>>>>>> 0e7ab435a8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 58c93ed806 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 21f7547af3 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 90c7b688e9 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> d1ecc0df13 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
>>>>>>> 422349e56d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> e0d00527f8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 93a68e91bb (Merge branch 'feature/postgis-fixes')
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> 3be8d2a5a4 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> d136bd4a2c (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> e980963df5 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
>>>>>>> 903b3b81c6 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> c576183101 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 42e8565e9b (Merge branch 'feature/postgis-fixes')
>>>>>>> 6841c84934 (Merge branch 'feature/postgis-fixes')
=======
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> 3be8d2a5a (Merge branch 'feature/postgis-fixes')
>>>>>>> db8d998aa2 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
>>>>>>> b368bb796e (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> 6841c84934 (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> dbed56f042 (GEOMESA-3254 Add Bloop build support)
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> d845d7c1bd (GEOMESA-3254 Add Bloop build support)
<<<<<<< HEAD
>>>>>>> c8d2cfae9c (GEOMESA-3254 Add Bloop build support)
=======
=======
>>>>>>> e980963df (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> e22b6ade6f (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
>>>>>>> 5e3d21a94f (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> ed2e337c3d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 67de3c3202 (Merge branch 'feature/postgis-fixes')
>>>>>>> b71b0e3cfc (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> e980963df (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> 3be8d2a5a (Merge branch 'feature/postgis-fixes')
>>>>>>> db8d998aa (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
>>>>>>> 1b25d7ddb4 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 823f734cb8 (Merge branch 'feature/postgis-fixes')
=======
=======
=======
=======
>>>>>>> 951b61baf (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 4ccb35072 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> c8b485118 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> e8cc4971c6 (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> 3a3424a161 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> cb6bda89b6 (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> 09d87762c5 (GEOMESA-3254 Add Bloop build support)
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> 1fc2df91c6 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 699117eca9 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
=======
>>>>>>> 5a4c24e020 (GEOMESA-3254 Add Bloop build support)
=======
=======
>>>>>>> 1fc2df91c6 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 4b71543a85 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 30559ea5c9 (Merge branch 'feature/postgis-fixes')
 * Crown Copyright (c) 2016-2023 Dstl
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> 0e7ab435a (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> 21f7547af (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> d1ecc0df1 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
 * Crown Copyright (c) 2016-2021 Dstl
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> e521cdaeb (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 42fbaa6c7a (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 3fce3b91e5 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
=======
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> 3be8d2a5a (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> e8cc4971c6 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> e944f1c88b (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> b0d44cc502 (Merge branch 'feature/postgis-fixes')
=======
=======
=======
=======
=======
>>>>>>> db8d998aa (Merge branch 'feature/postgis-fixes')
 * Crown Copyright (c) 2016-2022 Dstl
=======
 * Crown Copyright (c) 2016-2021 Dstl
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> e980963df (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 3a3424a161 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> dd15127a4b (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> aa977ecc5f (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
=======
=======
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> 3be8d2a5a (Merge branch 'feature/postgis-fixes')
>>>>>>> db8d998aa (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
<<<<<<< HEAD
>>>>>>> cb6bda89b6 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 26e5afc4ea (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> c5ef523249 (Merge branch 'feature/postgis-fixes')
=======
=======
=======
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> d845d7c1b (GEOMESA-3254 Add Bloop build support)
<<<<<<< HEAD
<<<<<<< HEAD
>>>>>>> 09d87762c5 (GEOMESA-3254 Add Bloop build support)
<<<<<<< HEAD
>>>>>>> 63a045a753 (GEOMESA-3254 Add Bloop build support)
<<<<<<< HEAD
>>>>>>> 82122ae50e (GEOMESA-3254 Add Bloop build support)
=======
=======
=======
=======
=======
>>>>>>> 1b25d7ddb (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
 * Crown Copyright (c) 2016-2023 Dstl
=======
=======
>>>>>>> db8d998aa (Merge branch 'feature/postgis-fixes')
=======
 * Crown Copyright (c) 2016-2023 Dstl
=======
>>>>>>> 867bb626d8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
 * Crown Copyright (c) 2016-2023 Dstl
=======
=======
>>>>>>> db8d998aa (Merge branch 'feature/postgis-fixes')
>>>>>>> da00c7bd68 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
 * Crown Copyright (c) 2016-2022 Dstl
=======
 * Crown Copyright (c) 2016-2021 Dstl
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
>>>>>>> e980963df (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> e22b6ade6 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 1fc2df91c6 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> b34574273f (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> acd22640e2 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
=======
=======
=======
>>>>>>> e980963df (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> da00c7bd68 (Merge branch 'feature/postgis-fixes')
=======
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> 3be8d2a5a (Merge branch 'feature/postgis-fixes')
>>>>>>> db8d998aa (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 1b25d7ddb (Merge branch 'feature/postgis-fixes')
>>>>>>> 699117eca9 (Merge branch 'feature/postgis-fixes')
>>>>>>> c69897d7bd (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 03796f30c1 (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> e980963df (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 867bb626d8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> a84d1830af (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> da00c7bd68 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 6c202d4480 (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> a4d0fcd200 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 838b7e581b (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 0e7ab435a8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> ef6b8fccdb (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 6f57a76c5d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 0e7ab435a8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 21f7547af3 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 71dfaa45da (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 6f08de2ab4 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 9838ac675d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> e0d00527f8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> 3be8d2a5a4 (Merge branch 'feature/postgis-fixes')
>>>>>>> 34472778d3 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 93a68e91bb (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> 6b41bcc08d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> c576183101 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 42e8565e9b (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 6841c84934 (Merge branch 'feature/postgis-fixes')
=======
=======
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> d845d7c1bd (GEOMESA-3254 Add Bloop build support)
>>>>>>> f1532f2313 (GEOMESA-3254 Add Bloop build support)
<<<<<<< HEAD
>>>>>>> dbed56f042 (GEOMESA-3254 Add Bloop build support)
=======
=======
>>>>>>> 7bbbc378d7 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> ed2e337c3d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 1b25d7ddb4 (Merge branch 'feature/postgis-fixes')
>>>>>>> 67de3c3202 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> b71b0e3cfc (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> 1b25d7ddb4 (Merge branch 'feature/postgis-fixes')
=======
=======
=======
>>>>>>> 951b61baf (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 4ccb35072 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> c8b485118 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> e8cc4971c6 (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> 3a3424a161 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> cb6bda89b6 (Merge branch 'feature/postgis-fixes')
 * Crown Copyright (c) 2016-2023 Dstl
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> 0e7ab435a (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> 21f7547af (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> d1ecc0df1 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
 * Crown Copyright (c) 2016-2021 Dstl
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> e521cdaeb (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 42fbaa6c7a (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 2f0f322607 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> e7e01a7501 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
=======
=======
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> 3be8d2a5a (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> e8cc4971c6 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> e944f1c88b (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 638b68d081 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 09e1125c28 (Merge branch 'feature/postgis-fixes')
=======
=======
=======
=======
=======
=======
>>>>>>> db8d998aa (Merge branch 'feature/postgis-fixes')
 * Crown Copyright (c) 2016-2022 Dstl
=======
 * Crown Copyright (c) 2016-2021 Dstl
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> e980963df (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 3a3424a161 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> dd15127a4b (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 59746cdccd (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 3804445eba (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
=======
=======
=======
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> 3be8d2a5a (Merge branch 'feature/postgis-fixes')
>>>>>>> db8d998aa (Merge branch 'feature/postgis-fixes')
=======
>>>>>>> 5a4c24e020 (GEOMESA-3254 Add Bloop build support)
>>>>>>> cb6bda89b6 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 26e5afc4ea (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 71adb695c5 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> b5fb9c834b (Merge branch 'feature/postgis-fixes')
=======
=======
=======
=======
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> d845d7c1b (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> 4b71543a85 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 09d87762c5 (GEOMESA-3254 Add Bloop build support)
<<<<<<< HEAD
>>>>>>> 63a045a753 (GEOMESA-3254 Add Bloop build support)
<<<<<<< HEAD
>>>>>>> 5a4c24e020 (GEOMESA-3254 Add Bloop build support)
<<<<<<< HEAD
>>>>>>> 2d904e5c26 (GEOMESA-3254 Add Bloop build support)
=======
=======
=======
=======
=======
=======
>>>>>>> 30559ea5c9 (Merge branch 'feature/postgis-fixes')
 * Crown Copyright (c) 2016-2023 Dstl
=======
=======
>>>>>>> db8d998aa (Merge branch 'feature/postgis-fixes')
=======
 * Crown Copyright (c) 2016-2023 Dstl
=======
>>>>>>> 867bb626d8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
 * Crown Copyright (c) 2016-2023 Dstl
=======
=======
>>>>>>> db8d998aa (Merge branch 'feature/postgis-fixes')
>>>>>>> da00c7bd68 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
 * Crown Copyright (c) 2016-2022 Dstl
=======
 * Crown Copyright (c) 2016-2021 Dstl
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
>>>>>>> e980963df (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> e22b6ade6 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 1fc2df91c6 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> b34574273f (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 4b71543a85 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> bfe6dff453 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
=======
=======
=======
=======
>>>>>>> e980963df (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> da00c7bd68 (Merge branch 'feature/postgis-fixes')
=======
=======
 * Crown Copyright (c) 2016-2022 Dstl
>>>>>>> 3be8d2a5a (Merge branch 'feature/postgis-fixes')
>>>>>>> db8d998aa (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 1b25d7ddb (Merge branch 'feature/postgis-fixes')
>>>>>>> 699117eca9 (Merge branch 'feature/postgis-fixes')
>>>>>>> c69897d7bd (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 30559ea5c9 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 25ff9d478a (Merge branch 'feature/postgis-fixes')
=======
=======
=======
>>>>>>> e980963df (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 867bb626d8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> b818c64b86 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> 8b6c6d5923 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
=======
>>>>>>> da00c7bd68 (Merge branch 'feature/postgis-fixes')
>>>>>>> ec6d06b576 (Merge branch 'feature/postgis-fixes')
<<<<<<< HEAD
>>>>>>> 3689edc98a (Merge branch 'feature/postgis-fixes')
=======
=======
>>>>>>> 5369b95fd8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 44b956e093 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at
 * http://www.opensource.org/licenses/apache2.0.php.
 ***********************************************************************/

package org.locationtech.geomesa.accumulo.data

import org.geotools.api.data._
import org.geotools.api.feature.simple.SimpleFeature
import org.geotools.filter.text.ecql.ECQL
import org.geotools.util.factory.Hints
import org.junit.runner.RunWith
import org.locationtech.geomesa.accumulo.TestWithFeatureType
import org.locationtech.geomesa.features.ScalaSimpleFeature
import org.locationtech.geomesa.features.ScalaSimpleFeature.copy
import org.locationtech.geomesa.security.SecurityUtils
import org.locationtech.geomesa.utils.collection.SelfClosingIterator
import org.specs2.runner.JUnitRunner

/**
 * This mostly tests KryoVisibilityRowEncoder
 */
@RunWith(classOf[JUnitRunner])
class AccumuloDataStoreNullAttributeVisibilityTest extends TestWithFeatureType {

<<<<<<< HEAD
  import scala.collection.JavaConverters._
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> f1532f2313 (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> 7564665969 (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> 7bbbc378d7 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 5a4c24e020 (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> 4b71543a85 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> b818c64b86 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
  import scala.collection.JavaConversions._
<<<<<<< HEAD
>>>>>>> e5f251e08c (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> e980963df5 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> d845d7c1bd (GEOMESA-3254 Add Bloop build support)
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> 58d14a257e (GEOMESA-3254 Add Bloop build support)
=======
=======
  import scala.collection.JavaConversions._
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> e22b6ade6f (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> 63a045a753 (GEOMESA-3254 Add Bloop build support)
=======
=======
  import scala.collection.JavaConversions._
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> b34574273f (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> b818c64b86 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
  import scala.collection.JavaConversions._
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 867bb626d8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
=======
=======
  import scala.collection.JavaConversions._
<<<<<<< HEAD
>>>>>>> e5f251e08c (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> a4d0fcd200 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> e980963df5 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 6b41bcc08d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> f1532f2313 (GEOMESA-3254 Add Bloop build support)
=======
=======
>>>>>>> 58d14a257e (GEOMESA-3254 Add Bloop build support)
>>>>>>> 7564665969 (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> 7bbbc378d7 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 63a045a753 (GEOMESA-3254 Add Bloop build support)
>>>>>>> 5a4c24e020 (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> 4b71543a85 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> b818c64b86 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
  import scala.collection.JavaConversions._
>>>>>>> e5f251e08c (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 5369b95fd8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))

  override val spec = "some_id:String,dtg:Date,*geo_location:Point:srid=4326,number:Integer,text:String;geomesa.visibility.level='attribute'"

  val visibility = "admin,user,user,user,user"

  val complete_feature = {
    val sf = new ScalaSimpleFeature(sft, "complete_feature")
    sf.setAttribute(0, "ABC123")
    sf.setAttribute(1, "2021-05-23T08:30:23.000Z)")
    sf.setAttribute(2, "POINT (36.1234 23.224)")
    sf.setAttribute(3, "42")
    sf.setAttribute(4, "The previous value was 42")
    SecurityUtils.setFeatureVisibility(sf, visibility)
    sf.getUserData.put(Hints.USE_PROVIDED_FID, java.lang.Boolean.TRUE)
    sf
  }

  val null_string_feature = {
    val sf = new ScalaSimpleFeature(sft, "null_string_feature")
    sf.setAttribute(0, "ABC1234")
    sf.setAttribute(1, "2021-05-23T08:30:23.000Z)")
    sf.setAttribute(2, "POINT (36.1234 23.224)")
    sf.setAttribute(3, null)
    sf.setAttribute(4, "The previous value was null")
    SecurityUtils.setFeatureVisibility(sf, visibility)
    sf.getUserData.put(Hints.USE_PROVIDED_FID, java.lang.Boolean.TRUE)
    sf
  }

  step {
    // Write features to datastore
    addFeatures(Seq(complete_feature, null_string_feature))
  }

  def queryByAuths(auths: String, filter: String): Seq[SimpleFeature] = {
<<<<<<< HEAD
    val ds = DataStoreFinder.getDataStore((dsParams ++ Map(AccumuloDataStoreParams.AuthsParam.key -> auths)).asJava).asInstanceOf[AccumuloDataStore]
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> f1532f2313 (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> 7564665969 (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> 7bbbc378d7 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> 5a4c24e020 (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> 4b71543a85 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> b818c64b86 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
    val ds = DataStoreFinder.getDataStore(dsParams ++ Map(AccumuloDataStoreParams.AuthsParam.key -> auths)).asInstanceOf[AccumuloDataStore]
<<<<<<< HEAD
>>>>>>> e5f251e08c (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> e980963df5 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> d845d7c1bd (GEOMESA-3254 Add Bloop build support)
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> 58d14a257e (GEOMESA-3254 Add Bloop build support)
=======
=======
    val ds = DataStoreFinder.getDataStore(dsParams ++ Map(AccumuloDataStoreParams.AuthsParam.key -> auths)).asInstanceOf[AccumuloDataStore]
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> e22b6ade6f (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> 63a045a753 (GEOMESA-3254 Add Bloop build support)
=======
=======
    val ds = DataStoreFinder.getDataStore(dsParams ++ Map(AccumuloDataStoreParams.AuthsParam.key -> auths)).asInstanceOf[AccumuloDataStore]
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> b34574273f (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> b818c64b86 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
    val ds = DataStoreFinder.getDataStore(dsParams ++ Map(AccumuloDataStoreParams.AuthsParam.key -> auths)).asInstanceOf[AccumuloDataStore]
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 867bb626d8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
=======
=======
    val ds = DataStoreFinder.getDataStore(dsParams ++ Map(AccumuloDataStoreParams.AuthsParam.key -> auths)).asInstanceOf[AccumuloDataStore]
<<<<<<< HEAD
>>>>>>> e5f251e08c (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
<<<<<<< HEAD
>>>>>>> a4d0fcd200 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> e5f251e08 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> e980963df5 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 6b41bcc08d (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> f1532f2313 (GEOMESA-3254 Add Bloop build support)
=======
=======
>>>>>>> 58d14a257e (GEOMESA-3254 Add Bloop build support)
>>>>>>> 7564665969 (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> 7bbbc378d7 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
>>>>>>> 63a045a753 (GEOMESA-3254 Add Bloop build support)
>>>>>>> 5a4c24e020 (GEOMESA-3254 Add Bloop build support)
=======
>>>>>>> 4b71543a85 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
>>>>>>> b818c64b86 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
=======
=======
    val ds = DataStoreFinder.getDataStore(dsParams ++ Map(AccumuloDataStoreParams.AuthsParam.key -> auths)).asInstanceOf[AccumuloDataStore]
>>>>>>> e5f251e08c (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
>>>>>>> 5369b95fd8 (GEOMESA-3091 Attribute level visibilities error with null attribute values (#2775))
    val query = new Query(sftName, ECQL.toFilter(filter))
    SelfClosingIterator(ds.getFeatureReader(query, Transaction.AUTO_COMMIT)).toSeq
  }

  def featureWithUserAuth(feature: ScalaSimpleFeature): SimpleFeature = {
    val sf = copy(feature) // deep (enough) copy
    sf.setAttribute(0, null)
    sf
  }

  def featureWithAdminAuth(feature: ScalaSimpleFeature): SimpleFeature = {
    val sf = copy(feature) // deep (enough) copy
    sf.setAttribute(1, null)
    sf.setAttribute(2, null)
    sf.setAttribute(3, null)
    sf.setAttribute(4, null)
    sf
  }

  "AccumuloDataStore" should {

    "correctly return all features with just user auth" in {
      val features = queryByAuths("user", "INCLUDE")
      features must containTheSameElementsAs(Seq(complete_feature, null_string_feature).map(featureWithUserAuth))
    }

    "correctly return all features with just admin auth" in {
      val features = queryByAuths("admin", "INCLUDE")
      features must containTheSameElementsAs(Seq(complete_feature, null_string_feature).map(featureWithAdminAuth))
    }

    "correctly return all features with user and admin auth" in {
      val features = queryByAuths("user,admin", "INCLUDE")
      features must containTheSameElementsAs(Seq(complete_feature, null_string_feature))
    }
  }
}
